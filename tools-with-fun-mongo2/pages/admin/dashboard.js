import { useEffect, useState } from 'react'; export default function Dashboard(){ const [tools,setTools]=useState([]); const [title,setTitle]=useState(''); const [cat,setCat]=useState(''); const [desc,setDesc]=useState(''); const [html,setHtml]=useState(''); const [msg,setMsg]=useState(''); useEffect(()=>{ fetch('/api/tools').then(r=>r.json()).then(d=>setTools(d.tools)) },[]); async function add(){ const slug = title.toLowerCase().replace(/\s+/g,'-'); const res = await fetch('/api/admin/tools',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({slug,title,category:cat,description:desc,html})}); const j=await res.json(); if(res.ok){ setMsg('Added'); setTools([j.tool,...tools]) } else setMsg('Error: '+j.error) } async function del(slug){ if(!confirm('Delete?')) return; const res = await fetch('/api/admin/tools/'+slug,{method:'DELETE'}); if(res.ok) setTools(tools.filter(t=>t.slug!==slug)); else setMsg('Delete error') } return <div style={{padding:20,maxWidth:1000,margin:'20px auto'}}><h2>Admin Dashboard</h2><div className='admin-note'>Manage tools</div><div style={{marginTop:12}}><input placeholder='Title' value={title} onChange={e=>setTitle(e.target.value)} /> <input placeholder='Category' value={cat} onChange={e=>setCat(e.target.value)} /> <br/><input placeholder='Short desc' value={desc} onChange={e=>setDesc(e.target.value)} style={{width:'60%'}}/><br/><textarea placeholder='HTML' value={html} onChange={e=>setHtml(e.target.value)} rows={6} style={{width:'100%'}}></textarea><br/><button onClick={add} className='btn'>Add Tool</button></div><div style={{marginTop:18}}><h3>Existing Tools</h3>{tools.map(t=>(<div key={t.slug} className='card' style={{marginBottom:8}}><h4>{t.title}</h4><small>{t.category}</small><p>{t.description}</p><button onClick={()=>del(t.slug)}>Delete</button></div>))}</div><div style={{marginTop:12,color:'#064e3b'}}>{msg}</div></div> }
